<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GCSE Confidence Tracker - All Subjects</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .confidence-btn {
            transition: all 0.2s ease;
        }
        .confidence-btn:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- PASTE YOUR FULL "scienceTopics" OBJECT HERE ---
        // (I have hidden it for brevity, but keep the full list from your original file)
        const scienceTopics = {
            history: [
                { id: 'h1', title: 'Depth 6: A world divided - Reasons for Cold War', subtopics: ['Long-term rivalry between USSR and West', 'Ideological differences (Communism vs Capitalism)', 'Tensions during WWII', 'Tehran Conference', 'Yalta Conference', 'Potsdam Conference', 'Soviet expansion in Eastern Europe', 'Attitudes of Truman and Stalin'] },
                { id: 'h2', title: 'Depth 6: Early Cold War 1945-49', subtopics: ['Soviet expansion in Eastern Europe', 'Churchill and Iron Curtain', 'Truman Doctrine', 'Marshall Plan', 'Cominform', 'Comecon', 'Bizonia disagreements', 'Berlin Crisis 1948-49', 'Berlin Airlift', 'NATO formation', 'Creation of FRG and GDR'] },
                { id: 'h3', title: 'Depth 6: Cold War in 1950s', subtopics: ['Korean War impact', 'Warsaw Pact formation', 'Khrushchev and peaceful co-existence', 'Soviet rule in Hungary', 'Rakosi', 'De-Stalinisation', 'Nagy and his demands', 'Soviet invasion of Hungary', 'Effects and international reaction', 'Nuclear arms race impact'] },
                { id: 'h4', title: 'Depth 6: Three crises', subtopics: ['U2 incident 1960', 'Paris Summit Conference effects', 'Berlin Wall construction 1961', 'Refugee problem', 'Effects of Berlin Wall', 'Bay of Pigs invasion', 'Cuban Missile Crisis causes', 'Cuban Missile Crisis events', 'Reasons for Crisis outcome', 'Soviet invasion of Czechoslovakia', 'Brezhnev Doctrine'] },
                { id: 'h5', title: 'Depth 6: Thaw and Détente 1963-72', subtopics: ['Hotline establishment', 'Test Ban Treaty', 'Outer Space Treaty', 'Nuclear Non-proliferation Treaty', 'Reasons for Détente', 'SALT talks', 'SALT treaty', 'Extent of Détente 1972'] },
                { id: 'h6', title: 'Depth 7: Red Scare and McCarthyism', subtopics: ['Reasons for Red Scare', 'Cold War 1945-50', 'Hiss case', 'Rosenberg case', 'FBI role', 'HUAC', 'Hollywood Ten', 'McCarthy\'s methods', 'Growth of opposition', 'McCarthy\'s downfall', 'Overall impact on USA'] },
                { id: 'h7', title: 'Depth 7: Civil rights 1950s', subtopics: ['Segregation and discrimination', 'Supreme Court influence', 'Congress influence', 'Brown v Board of Education 1954', 'Death of Emmett Till 1955', 'Montgomery Bus Boycott 1955-56', 'Montgomery events and significance', 'Little Rock 1957', 'Civil Rights Act 1957', 'KKK revival'] },
                { id: 'h8', title: 'Depth 7: Civil rights protests 1960-74', subtopics: ['Freedom riders', 'Anniston fire bombing', 'Sit-ins', 'Voting rights', 'Meredith Case', 'Martin Luther King methods', 'Birmingham Campaign', 'Washington March', 'Dream speech', 'Mississippi Freedom Summer', '1960s civil rights legislation', 'Selma and voting rights', 'Nation of Islam', 'Malcolm X', 'Black Power growth', 'Stokely Carmichael', '1968 Olympics', 'Watts riots', 'Black Panther movement', 'Bobby Seale', 'Huey Newton'] },
                { id: 'h9', title: 'Depth 7: Other protest movements', subtopics: ['Reasons for protest growth', 'Student movement', 'Links to Vietnam War', 'Anti-Vietnam War movement', 'Berkeley Free Speech movement', 'Students for a Democratic Society', 'Hippies', 'Betty Friedan', 'Eleanor Roosevelt', 'NOW', 'Women\'s liberation movement', 'Abortion', 'Phyllis Schlafly', 'Opposition to women\'s movement'] },
                { id: 'h10', title: 'Depth 7: Nixon and Watergate', subtopics: ['Reasons for Watergate Scandal', 'Key features of Watergate', 'Impact on Nixon', 'Impact on US politics', 'War Powers Act 1973', 'Election Campaign Act 1974', 'Privacy Act 1974', 'Congressional Budget Control Act 1974', 'Gerald Ford', 'Presidential pardon'] },
                { id: 'h11', title: 'Investigation A4: Struggle against France 1945-54', subtopics: ['First Indochina War origins', 'Vietminh aims', 'General Giap tactics', 'Search for diplomatic solution', 'French defeat at Dien Bien Phu', 'Immediate consequences'] },
                { id: 'h12', title: 'Investigation A4: US policy 1954-64', subtopics: ['Geneva Conference 1954 aims', 'US response', 'Eisenhower and Domino Theory', 'South Vietnam formation', 'Life under Ho Chi Minh', 'Life under Ngo Dinh Diem', 'Ho\'s policies to unite Vietnam', 'NLF', 'Ho Chi Minh Trail', 'US response', 'Strategic Hamlet Programme', 'Fall of Diem 1963', 'Gulf of Tonkin incident 1964'] },
                { id: 'h13', title: 'Investigation A4: Escalation 1964-68', subtopics: ['Second Indochina War nature', 'Johnson\'s role', 'McNamara\'s role', 'Westmoreland\'s role', 'Jungle war 1965-68', 'Search and Destroy', 'Bombing campaign', 'Operation Rolling Thunder', 'Televised war', 'Siege of Khe Sanh', 'Tet Offensive', 'Battle of Hue 1968'] },
                { id: 'h14', title: 'Investigation A4: Vietnamisation 1969-75', subtopics: ['Failure of peace talks', 'Widening war in Cambodia', 'Widening war in Laos', 'Secret bombing', 'Relations with China', 'Kissinger\'s role', 'Le Duc Tho\'s role', 'Paris peace talks 1972', 'Vietnamisation policy', 'Withdrawal by 1973', 'Renewed North Vietnamese offensive', 'Ford\'s diplomatic response', 'Final offensive March-April 1975', 'Fall of Saigon'] },
                { id: 'h15', title: 'Investigation A4: Impact on civilians', subtopics: ['Effects on Vietnamese civilians', 'US response to guerrilla warfare', 'Hearts and Minds', 'My Lai', 'Phoenix Programme', 'Defoliation', 'Bombing of civilians', 'Effects of war in US', 'University protests', 'Media coverage', 'Opposition to war in USA', 'Pro-war demonstrations', 'Fulbright Hearings 1971'] },
                { id: 'h16', title: 'Breadth B2: Progress mid-19th century', subtopics: ['Barriers to progress', 'Lack of understanding disease causes', 'Florence Nightingale at Scutari', 'Changes in nursing', 'Hospital improvements', 'Dangers in surgery (pain, infection, bleeding)', 'Simpson and chloroform', 'Chadwick\'s work', 'Public health problems', 'Public Health Act 1848', 'Cholera threat', 'John Snow\'s work'] },
                { id: 'h17', title: 'Breadth B2: Discovery 1860-75', subtopics: ['Pasteur\'s work', 'Germ theory development', 'Effects of germ theory', 'Lister\'s improvements in surgery', 'Antiseptics impact', 'Government action on public health', 'Public Health Act 1875 significance', 'Nightingale continuing improvements', 'Hospital improvements', 'Nursing improvements', 'Elizabeth Garrett', 'Progress of women in medicine'] },
                { id: 'h18', title: 'Breadth B2: Accelerating change 1875-1905', subtopics: ['Fight against germs', 'Koch and bacteriology', 'Aseptic surgery', 'Public Health Act 1875 impact', 'Science and medicine', 'Blood transfusions', 'Magic bullets', 'Ehrlich\'s work', 'Radioactivity', 'Marie Curie\'s impact'] },
                { id: 'h19', title: 'Breadth B2: Government action 1905-20', subtopics: ['Liberal Government measures 1906-11', 'Public health impact', 'First World War importance', 'WWI role of women in medicine', 'WWI improvements in medical treatment', 'Surgery improvements', 'X-rays', 'Blood transfusion', 'Fighting infection'] },
                { id: 'h20', title: 'Breadth B2: Advances 1920-48', subtopics: ['Penicillin development', 'Fleming\'s role', 'Florey\'s role', 'Chain\'s role', 'Second World War importance', 'WWII developments in surgery', 'Skin grafts', 'Blood transfusion advances', 'Role of women in medicine', 'Beveridge', 'NHS development', 'NHS importance for public health'] }
            ],
            religiousstudies: [
                { id: 're1', title: 'Christianity: Beliefs and teachings', subtopics: ['Nature of God (omnipotent, loving, just)', 'Problem of evil and suffering', 'The Trinity (Father, Son, Holy Spirit)', 'Creation (Word and Spirit)', 'Afterlife (resurrection, judgement, heaven, hell)', 'Incarnation and Jesus as Son of God', 'Crucifixion, resurrection, ascension', 'Sin and original sin', 'Salvation (law, grace, Spirit)', 'Atonement'] },
                { id: 're2', title: 'Christianity: Practices', subtopics: ['Forms of worship (liturgical, non-liturgical, informal)', 'Private worship and use of Bible', 'Prayer (Lord\'s Prayer, set and informal)', 'Sacraments meaning', 'Baptism (infant and believers)', 'Holy Communion/Eucharist', 'Pilgrimage (Lourdes and Iona)', 'Christmas and Easter celebrations', 'Church in local community (food banks, street pastors)', 'Mission, evangelism, Church growth', 'Reconciliation and persecution', 'CAFOD/Christian Aid/Tearfund'] },
                { id: 're3', title: 'Judaism: Beliefs and teachings', subtopics: ['Nature of God (one, Creator, Law-Giver, Judge)', 'God as loving and merciful', 'Divine presence (Shekhinah)', 'Life after death, judgement, resurrection', 'Messiah and different views', 'Covenant with Abraham', 'Covenant at Sinai and Moses', 'Ten Commandments', 'Justice, healing the world, charity, kindness', 'Sanctity of life (Pikuach Nefesh)', 'Free will and 613 mitzvot', 'Mitzvot: man-God and man-man'] },
                { id: 're4', title: 'Judaism: Practices', subtopics: ['Synagogue and its importance', 'Synagogue design (bimah, aron hakodesh, ner tamid)', 'Orthodox vs Reform synagogues', 'Synagogue services', 'Amidah (standing prayer)', 'Shabbat (home and synagogue)', 'Home worship and private prayer', 'Tenakh and Talmud', 'Birth ceremonies (Brit Milah)', 'Bar and Bat Mitzvah', 'Marriage ceremony', 'Mourning rituals', 'Dietary laws (kosher, trefah, milk and meat)', 'Rosh Hashanah and Yom Kippur', 'Pesach'] },
                { id: 're5', title: 'Theme A: Relationships and families', subtopics: ['Human sexuality (heterosexual, same-sex)', 'Sex before and outside marriage', 'Contraception and family planning', 'Nature and purpose of marriage', 'Same-sex marriage and cohabitation', 'Divorce and remarrying', 'Ethical arguments on divorce', 'Role of parents and children', 'Extended and nuclear families', 'Purpose of families', 'Same-sex parents', 'Polygamy', 'Roles of men and women', 'Gender equality', 'Gender prejudice and discrimination'] },
                { id: 're6', title: 'Theme B: Religion and life', subtopics: ['Origins of universe (religious teachings)', 'Big Bang and religious views', 'Stewardship and dominion', 'Responsibility for environment', 'Use and abuse of environment', 'Animal experimentation', 'Animals for food', 'Origins of human life', 'Evolution and religious views', 'Sanctity of life', 'Quality of life', 'Abortion and ethical arguments', 'Euthanasia', 'Death and afterlife beliefs'] },
                { id: 're7', title: 'Theme C: Existence of God and revelation', subtopics: ['Design argument', 'First Cause argument', 'Argument from miracles', 'Evil and suffering vs God', 'Science against God', 'Special revelation (visions)', 'Enlightenment', 'General revelation (nature, scripture)', 'Divine nature (omnipotent, omniscient)', 'Personal and impersonal divine', 'Immanent and transcendent', 'Value of revelation sources', 'Alternative explanations for experiences'] },
                { id: 're8', title: 'Theme D: Religion, peace and conflict', subtopics: ['Peace, justice, forgiveness, reconciliation', 'Violence and violent protest', 'Terrorism', 'Reasons for war', 'Just war theory', 'Holy war', 'Pacifism', 'Religion as cause of conflict', 'Nuclear weapons and deterrence', 'Weapons of mass destruction', 'Religion and peace-making', 'Religious responses to war victims'] }
            ],
            computing: [
                { id: 'cs1', title: '1.1 Systems architecture', subtopics: ['CPU purpose and fetch-execute cycle', 'CPU components (ALU, CU, Cache, Registers)', 'Von Neumann architecture', 'Clock speed, cache size, cores', 'Embedded systems'] },
                { id: 'cs2', title: '1.2 Memory and storage', subtopics: ['Primary storage (RAM and ROM)', 'Virtual memory and cache', 'Secondary storage types', 'Storage characteristics', 'Data units (bit to petabyte)', 'Binary, denary, hexadecimal conversion', 'Binary addition and shifts', 'Character sets (ASCII, Unicode)', 'Image representation and metadata', 'Sound sampling and storage', 'Compression (lossy and lossless)'] },
                { id: 'cs3', title: '1.3 Networks and protocols', subtopics: ['LAN and WAN', 'Network performance factors', 'Client-server and peer-to-peer', 'Network hardware (routers, switches, NIC)', 'DNS, hosting, cloud, web servers', 'Star and mesh topologies', 'Wired vs wireless connections', 'Encryption', 'IP and MAC addressing', 'Protocols (TCP/IP, HTTP, HTTPS, FTP, POP, IMAP, SMTP)', 'Layers in protocols'] },
                { id: 'cs4', title: '1.4 Network security', subtopics: ['Forms of attack (malware, phishing, brute-force, DoS, SQL injection)', 'Prevention methods (penetration testing, anti-malware, firewalls, passwords, encryption)'] },
                { id: 'cs5', title: '1.5 Systems software', subtopics: ['Operating systems functions', 'User interface', 'Memory management and multitasking', 'Peripheral and user management', 'File management', 'Utility software (encryption, defragmentation, compression)'] },
                { id: 'cs6', title: '1.6 Impacts of technology', subtopics: ['Ethical, legal, cultural, environmental issues', 'Privacy issues', 'Data Protection Act 2018', 'Computer Misuse Act 1990', 'Copyright Designs and Patents Act 1988', 'Software licences (open source vs proprietary)'] },
                { id: 'cs7', title: '2.1 Algorithms', subtopics: ['Computational thinking (abstraction, decomposition, algorithmic thinking)', 'Inputs, processes, outputs', 'Structure diagrams', 'Pseudocode and flowcharts', 'Trace tables', 'Binary and linear search', 'Bubble, merge, insertion sort'] },
                { id: 'cs8', title: '2.2 Programming fundamentals', subtopics: ['Variables, constants, operators', 'Sequence, selection, iteration', 'Arithmetic and comparison operators', 'Boolean operators (AND, OR, NOT)', 'Data types (integer, real, boolean, character, string)', 'Casting', 'String manipulation', 'File handling operations', 'Records and SQL', '1D and 2D arrays', 'Functions and procedures', 'Random number generation'] },
                { id: 'cs9', title: '2.3 Robust programs', subtopics: ['Defensive design', 'Anticipating misuse', 'Authentication', 'Input validation', 'Maintainability (sub programs, naming, indentation, commenting)', 'Iterative and final testing', 'Syntax and logic errors', 'Test data (normal, boundary, invalid, erroneous)', 'Test plans'] },
                { id: 'cs10', title: '2.4 Boolean logic', subtopics: ['Logic diagrams (AND, OR, NOT gates)', 'Truth tables', 'Combining Boolean operators'] },
                { id: 'cs11', title: '2.5 Programming languages and IDEs', subtopics: ['High-level vs low-level languages', 'Translators', 'Compilers vs interpreters', 'IDE tools (editors, error diagnostics, run-time environment)'] }
            ],
            mathematics: [
                { id: 'm1', title: '3.1 Number', subtopics: ['Order positive and negative numbers', 'Four operations and place value', 'Relationships between operations', 'Prime numbers and factors', 'Systematic listing strategies', 'Powers and roots', 'Calculate with roots and indices', 'Calculate with fractions, multiples of π and surds', 'Standard form', 'Work with terminating and recurring decimals', 'Fractions in ratio problems', 'Fractions and percentages as operators', 'Standard units of measure', 'Estimate and check calculations', 'Round numbers and measures', 'Limits of accuracy and bounds'] },
                { id: 'm2', title: '3.2 Algebra', subtopics: ['Algebraic notation', 'Substitute into formulae', 'Expressions, equations and inequalities', 'Simplify and manipulate expressions', 'Rearrange formulae', 'Equations and identities', 'Functions and inverse functions', 'Coordinates and graphs', 'Straight-line graphs', 'Gradients and intercepts', 'Quadratic graphs and roots', 'Sketch various function graphs', 'Translations and reflections of functions', 'Plot and interpret graphs in context', 'Gradients and areas under graphs', 'Equation of a circle', 'Solve linear equations', 'Solve quadratic equations', 'Solve simultaneous equations', 'Numerical iteration', 'Translate situations into algebra', 'Solve linear and quadratic inequalities', 'Generate terms of a sequence', 'Recognise sequences', 'nth term of sequences'] },
                { id: 'm3', title: '3.3 Ratio, proportion and rates of change', subtopics: ['Change between standard units', 'Scale factors and maps', 'One quantity as a fraction of another', 'Ratio notation', 'Divide quantities in ratios', 'Multiplicative relationships', 'Proportion as equality of ratios', 'Ratios to fractions and functions', 'Percentages and percentage change', 'Direct and inverse proportion', 'Compound units', 'Compare using ratio notation', 'Direct and inverse proportion equations', 'Interpret gradients and rates of change', 'Instantaneous rate of change', 'Growth and decay problems'] },
                { id: 'm4', title: '3.4 Geometry and measures', subtopics: ['Notation and conventions', 'Ruler and compass constructions', 'Angle properties', 'Properties of quadrilaterals and triangles', 'Congruence criteria', 'Angle facts and proofs', 'Congruent and similar shapes', 'Combinations of transformations', 'Circle definitions and properties', 'Circle theorems', 'Coordinate geometry', 'Properties of 3D shapes', 'Plans and elevations', 'Standard units of measure', 'Measure line segments and angles', 'Area and volume formulae', 'Circumference and area of circles', 'Arc lengths and sectors', 'Congruence and similarity', 'Pythagoras and trigonometry', 'Exact trig values', 'Sine and cosine rules', 'Area of any triangle', 'Vectors as translations', 'Vector operations'] },
                { id: 'm5', title: '3.5 Probability', subtopics: ['Record frequency of outcomes', 'Randomness and expected outcomes', 'Relative frequency and theoretical probability', 'Probability properties', 'Empirical vs theoretical distributions', 'Enumerate sets systematically', 'Theoretical possibility spaces', 'Independent and dependent events', 'Conditional probabilities'] },
                { id: 'm6', title: '3.6 Statistics', subtopics: ['Sample from populations', 'Construct tables and charts', 'Histograms and cumulative frequency', 'Measures of central tendency and spread', 'Apply statistics to populations', 'Scatter graphs and correlation'] }
            ],
            biology: [
                { id: 'b1', title: '4.1 Cell biology', subtopics: ['Eukaryotes and prokaryotes', 'Animal and plant cells', 'Cell specialisation', 'Cell differentiation', 'Microscopy', 'Mitosis and the cell cycle', 'Stem cells', 'Diffusion', 'Osmosis', 'Active transport'] },
                { id: 'b2', title: '4.2 Organisation', subtopics: ['Principles of organisation', 'The human digestive system', 'The heart and blood vessels', 'Blood', 'Coronary heart disease', 'Health issues', 'Effect of lifestyle', 'Cancer', 'Plant tissues', 'Plant organ system'] },
                { id: 'b3', title: '4.3 Infection and response', subtopics: ['Communicable diseases', 'Viral diseases', 'Bacterial diseases', 'Fungal diseases', 'Protist diseases', 'Human defence systems', 'Vaccination', 'Antibiotics and painkillers', 'Discovery of drugs'] },
                { id: 'b4', title: '4.4 Bioenergetics', subtopics: ['Photosynthetic reaction', 'Rate of photosynthesis', 'Uses of glucose', 'Aerobic and anaerobic respiration', 'Response to exercise', 'Metabolism'] },
                { id: 'b5', title: '4.5 Homeostasis and response', subtopics: ['Homeostasis', 'The human nervous system', 'Human endocrine system', 'Blood glucose concentration', 'Hormones in reproduction', 'Contraception', 'Feedback systems (HT)'] },
                { id: 'b6', title: '4.6 Inheritance, variation and evolution', subtopics: ['Sexual and asexual reproduction', 'Meiosis', 'DNA and the genome', 'Genetic inheritance', 'Inherited disorders', 'Sex determination', 'Variation', 'Evolution', 'Selective breeding', 'Genetic engineering', 'Evidence for evolution', 'Fossils', 'Extinction', 'Resistant bacteria', 'Classification'] },
                { id: 'b7', title: '4.7 Ecology', subtopics: ['Communities', 'Abiotic factors', 'Biotic factors', 'Adaptations', 'Levels of organisation', 'How materials are cycled', 'Biodiversity', 'Waste management', 'Land use', 'Deforestation', 'Global warming', 'Maintaining biodiversity'] }
            ],
            chemistry: [
                { id: 'c1', title: '5.1 Atomic structure and the periodic table', subtopics: ['Atoms, elements and compounds', 'Mixtures', 'Development of the atomic model', 'Relative electrical charges', 'Size and mass of atoms', 'Relative atomic mass', 'Electronic structure', 'The periodic table', 'Development of periodic table', 'Metals and non-metals', 'Group 0', 'Group 1', 'Group 7'] },
                { id: 'c2', title: '5.2 Bonding, structure, and properties', subtopics: ['Chemical bonds', 'Ionic bonding', 'Ionic compounds', 'Covalent bonding', 'Metallic bonding', 'Three states of matter', 'State symbols', 'Properties of ionic compounds', 'Properties of small molecules', 'Polymers', 'Giant covalent structures', 'Properties of metals and alloys', 'Metals as conductors', 'Diamond', 'Graphite', 'Graphene and fullerenes'] },
                { id: 'c3', title: '5.3 Quantitative chemistry', subtopics: ['Conservation of mass', 'Relative formula mass', 'Mass changes when gas involved', 'Chemical measurements', 'Moles (HT)', 'Amounts in equations (HT)', 'Using moles to balance (HT)', 'Limiting reactants (HT)', 'Concentration of solutions'] },
                { id: 'c4', title: '5.4 Chemical changes', subtopics: ['Metal oxides', 'The reactivity series', 'Extraction of metals', 'Oxidation and reduction (HT)', 'Reactions with metals', 'Neutralisation and salt production', 'Soluble salts', 'The pH scale', 'Strong and weak acids (HT)', 'Electrolysis process', 'Electrolysis of molten compounds', 'Using electrolysis to extract metals', 'Electrolysis of aqueous solutions', 'Half equations (HT)'] },
                { id: 'c5', title: '5.5 Energy changes', subtopics: ['Exothermic and endothermic reactions', 'Reaction profiles', 'Energy change of reactions (HT)'] },
                { id: 'c6', title: '5.6 Rate and extent of chemical change', subtopics: ['Calculating rates', 'Factors affecting rates', 'Collision theory', 'Catalysts', 'Reversible reactions', 'Energy changes in reversible reactions', 'Equilibrium', 'Effect of conditions on equilibrium (HT)', 'Effect of concentration (HT)', 'Effect of temperature (HT)', 'Effect of pressure (HT)'] },
                { id: 'c7', title: '5.7 Organic chemistry', subtopics: ['Crude oil and hydrocarbons', 'Fractional distillation', 'Properties of hydrocarbons', 'Cracking and alkenes'] },
                { id: 'c8', title: '5.8 Chemical analysis', subtopics: ['Pure substances', 'Formulations', 'Chromatography', 'Test for hydrogen', 'Test for oxygen', 'Test for carbon dioxide', 'Test for chlorine'] },
                { id: 'c9', title: '5.9 Chemistry of the atmosphere', subtopics: ['Proportions of gases', "Earth's early atmosphere", 'How oxygen increased', 'How carbon dioxide decreased', 'Greenhouse gases', 'Human activities and greenhouse gases', 'Global climate change', 'Carbon footprint', 'Atmospheric pollutants', 'Properties and effects of pollutants'] },
                { id: 'c10', title: '5.10 Using resources', subtopics: ['Using Earth\'s resources', 'Potable water', 'Waste water treatment', 'Alternative metal extraction (HT)', 'Life cycle assessment', 'Ways of reducing resource use'] }
            ],
            physics: [
                { id: 'p1', title: '6.1 Energy', subtopics: ['Energy stores and systems', 'Changes in energy', 'Energy changes in systems', 'Power', 'Energy transfers', 'Efficiency', 'National and global energy resources'] },
                { id: 'p2', title: '6.2 Electricity', subtopics: ['Circuit diagram symbols', 'Electrical charge and current', 'Current, resistance and pd', 'Resistors', 'Series and parallel circuits', 'Direct and alternating pd', 'Mains electricity', 'Power', 'Energy transfers in appliances', 'The National Grid'] },
                { id: 'p3', title: '6.3 Particle model of matter', subtopics: ['Density of materials', 'Changes of state', 'Internal energy', 'Temperature changes and specific heat', 'Specific latent heat', 'Particle motion in gases'] },
                { id: 'p4', title: '6.4 Atomic structure', subtopics: ['Structure of an atom', 'Mass number and isotopes', 'Development of atomic model', 'Radioactive decay', 'Nuclear equations', 'Half-lives', 'Radioactive contamination'] },
                { id: 'p5', title: '6.5 Forces', subtopics: ['Scalar and vector quantities', 'Contact and non-contact forces', 'Gravity', 'Resultant forces', 'Work done and energy transfer', 'Forces and elasticity', 'Describing motion', 'Distance and displacement', 'Speed', 'Velocity', 'Distance-time graphs', 'Acceleration', 'Newton\'s First Law', 'Newton\'s Second Law', 'Newton\'s Third Law', 'Stopping distance', 'Reaction time', 'Braking distance', 'Momentum (HT)'] },
                { id: 'p6', title: '6.6 Waves', subtopics: ['Transverse and longitudinal waves', 'Properties of waves', 'Types of electromagnetic waves', 'Properties of EM waves', 'Uses of EM waves'] },
                { id: 'p7', title: '6.7 Magnetism and electromagnetism', subtopics: ['Poles of a magnet', 'Magnetic fields', 'Electromagnetism', 'Fleming\'s left-hand rule (HT)', 'Electric motors (HT)'] }
            ]
        };

        const confidenceLevels = [
            { value: 0, label: 'Not Started', color: 'bg-[#F5E6E8]', hoverColor: 'hover:bg-[#E5D6D8]' },
            { value: 1, label: 'Needs Work', color: 'bg-[#D5C6E0]', hoverColor: 'hover:bg-[#C5B6D0]' },
            { value: 2, label: 'Getting There', color: 'bg-[#BAA3C4]', hoverColor: 'hover:bg-[#AA93B4]' },
            { value: 3, label: 'Confident', color: 'bg-[#967AA1]', hoverColor: 'hover:bg-[#866A91]' },
            { value: 4, label: 'Mastered', color: 'bg-[#785685]', hoverColor: 'hover:bg-[#684675]' }
        ];

        function App() {
            const [activeTab, setActiveTab] = useState('biology');
            const [confidence, setConfidence] = useState({});
            const [expandedTopics, setExpandedTopics] = useState({});
            const [isLoading, setIsLoading] = useState(true);

            // UPDATED: Load from API instead of window.storage
            useEffect(() => {
                loadConfidence();
            }, []);

            const loadConfidence = async () => {
                try {
                    const response = await fetch('/api/confidence');
                    if (response.ok) {
                        const data = await response.json();
                        setConfidence(data);
                    }
                } catch (error) {
                    console.error('Error loading data:', error);
                } finally {
                    setIsLoading(false);
                }
            };

            // UPDATED: Save to API
            const saveConfidence = async (newConfidence) => {
                try {
                    await fetch('/api/confidence', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(newConfidence),
                    });
                } catch (error) {
                    console.error('Failed to save:', error);
                }
            };

            const updateConfidence = (topicId, subtopicIndex, level) => {
                const key = `${topicId}-${subtopicIndex}`;
                const newConfidence = { ...confidence, [key]: level };
                setConfidence(newConfidence);
                saveConfidence(newConfidence);
            };

            const toggleTopic = (topicId) => {
                setExpandedTopics(prev => ({ ...prev, [topicId]: !prev[topicId] }));
            };

            const getTopicProgress = (topic) => {
                let total = topic.subtopics.length;
                let completed = 0;
                topic.subtopics.forEach((_, index) => {
                    const key = `${topic.id}-${index}`;
                    if (confidence[key] >= 3) completed++;
                });
                return { completed, total, percentage: total > 0 ? (completed / total * 100) : 0 };
            };

            const getSubjectProgress = (subject) => {
                const topics = scienceTopics[subject];
                let totalSubtopics = 0;
                let completedSubtopics = 0;
                
                topics.forEach(topic => {
                    totalSubtopics += topic.subtopics.length;
                    topic.subtopics.forEach((_, index) => {
                        const key = `${topic.id}-${index}`;
                        if (confidence[key] >= 3) completedSubtopics++;
                    });
                });
                
                return { completed: completedSubtopics, total: totalSubtopics, percentage: totalSubtopics > 0 ? (completedSubtopics / totalSubtopics * 100) : 0 };
            };

            const getOverallProgress = () => {
                let total = 0;
                let completed = 0;
                
                Object.keys(scienceTopics).forEach(subject => {
                    const progress = getSubjectProgress(subject);
                    total += progress.total;
                    completed += progress.completed;
                });
                
                return { completed, total, percentage: total > 0 ? (completed / total * 100) : 0 };
            };

            if (isLoading) {
                return (
                    <div className="min-h-screen flex items-center justify-center">
                        <div className="text-gray-600">Loading...</div>
                    </div>
                );
            }

            const currentTopics = scienceTopics[activeTab];
            const overallProgress = getOverallProgress();

            return (
                <div className="min-h-screen bg-gray-50">
                    {/* Header */}
                    <div className="bg-white shadow">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                            <h1 className="text-3xl font-bold text-gray-900">GCSE Confidence Tracker</h1>
                            <p className="text-gray-600 mt-1">Track your confidence across all subjects</p>
                            
                            {/* Overall Progress */}
                            <div className="mt-4">
                                <div className="flex justify-between text-sm mb-2">
                                    <span className="font-medium text-gray-700">Overall Progress</span>
                                    <span className="text-gray-600">{overallProgress.completed} / {overallProgress.total} topics confident</span>
                                </div>
                                <div className="w-full bg-gray-200 rounded-full h-3">
                                    <div 
                                        className="bg-[#967AA1] h-3 rounded-full transition-all duration-500"
                                        style={{ width: `${overallProgress.percentage}%` }}
                                    ></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                        {/* Tabs */}
                        <div className="flex space-x-1 bg-gray-200 p-1 rounded-lg mb-6">
                            {Object.keys(scienceTopics).map(subject => {
                                const progress = getSubjectProgress(subject);
                                return (
                                    <button
                                        key={subject}
                                        onClick={() => setActiveTab(subject)}
                                        className={`flex-1 py-3 px-4 rounded-md font-medium transition-all ${
                                            activeTab === subject
                                                ? 'bg-white text-gray-900 shadow'
                                                : 'text-gray-600 hover:text-gray-900'
                                        }`}
                                    >
                                        <div className="flex flex-col items-center">
                                            <span className="capitalize">{subject === 'religiousstudies' ? 'RE' : subject}</span>
                                            <span className="text-xs mt-1 opacity-75">{Math.round(progress.percentage)}%</span>
                                        </div>
                                    </button>
                                );
                            })}
                        </div>

                        {/* Legend */}
                        <div className="bg-white rounded-lg shadow p-4 mb-6">
                            <h3 className="font-semibold text-gray-700 mb-3">Confidence Levels</h3>
                            <div className="flex flex-wrap gap-4">
                                {confidenceLevels.map(level => (
                                    <div key={level.value} className="flex items-center space-x-2">
                                        <div className={`w-4 h-4 rounded ${level.color}`}></div>
                                        <span className="text-sm text-gray-600">{level.label}</span>
                                    </div>
                                ))}
                            </div>
                        </div>

                        {/* Topics */}
                        <div className="space-y-4">
                            {currentTopics.map(topic => {
                                const progress = getTopicProgress(topic);
                                const isExpanded = expandedTopics[topic.id];
                                
                                return (
                                    <div key={topic.id} className="bg-white rounded-lg shadow overflow-hidden">
                                        {/* Topic Header */}
                                        <button
                                            onClick={() => toggleTopic(topic.id)}
                                            className="w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors"
                                        >
                                            <div className="flex items-center space-x-4 flex-1">
                                                <svg 
                                                    className={`w-5 h-5 text-gray-400 transition-transform ${isExpanded ? 'transform rotate-90' : ''}`}
                                                    fill="none" 
                                                    stroke="currentColor" 
                                                    viewBox="0 0 24 24"
                                                >
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                                                </svg>
                                                <div className="text-left flex-1">
                                                    <h3 className="font-semibold text-gray-900">{topic.title}</h3>
                                                    <p className="text-sm text-gray-500 mt-1">{topic.subtopics.length} subtopics</p>
                                                </div>
                                            </div>
                                            <div className="flex items-center space-x-4">
                                                <div className="text-right">
                                                    <div className="text-sm font-medium text-gray-900">{Math.round(progress.percentage)}%</div>
                                                    <div className="text-xs text-gray-500">{progress.completed}/{progress.total}</div>
                                                </div>
                                                <div className="w-24 bg-gray-200 rounded-full h-2">
                                                    <div 
                                                        className="bg-[#967AA1] h-2 rounded-full transition-all duration-500"
                                                        style={{ width: `${progress.percentage}%` }}
                                                    ></div>
                                                </div>
                                            </div>
                                        </button>

                                        {/* Subtopics */}
                                        {isExpanded && (
                                            <div className="border-t border-gray-200 px-6 py-4 bg-gray-50">
                                                <div className="space-y-3">
                                                    {topic.subtopics.map((subtopic, index) => {
                                                        const key = `${topic.id}-${index}`;
                                                        const currentConfidence = confidence[key] || 0;
                                                        
                                                        return (
                                                            <div key={index} className="bg-white rounded-lg p-4 shadow-sm">
                                                                <div className="flex items-center justify-between">
                                                                    <span className="text-sm font-medium text-gray-700 flex-1">{subtopic}</span>
                                                                    <div className="flex space-x-2 ml-4">
                                                                        {confidenceLevels.map(level => (
                                                                            <button
                                                                                key={level.value}
                                                                                onClick={() => updateConfidence(topic.id, index, level.value)}
                                                                                className={`confidence-btn w-10 h-10 rounded-lg ${level.color} ${level.hoverColor} ${
                                                                                    currentConfidence === level.value ? 'ring-2 ring-offset-2 ring-gray-400' : ''
                                                                                }`}
                                                                                title={level.label}
                                                                            ></button>
                                                                        ))}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        );
                                                    })}
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</body>
</html>
